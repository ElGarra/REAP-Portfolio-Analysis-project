# Asset Management Project README

## Project Context

This project was developed as the final assignment for the "Asset Management" course taught by Gregoire Hug, specifically tailored for students specializing in Digital Data for Finance (DDEFi) at the Ã‰cole Centrale de Marseille. It focuses on scraping financial data from Yahoo Finance to construct an investment portfolio and conduct a backtest against a benchmark.

## Project Structure

### assets/
Contains various files used in the project's final presentation (pitch) and data analysis. The folder includes:
- **Graphical Outputs**: Visuals like `cumulative_returns.png` and `drawdown.png` used during the pitch.
- **Numerical Data and Analysis**:
  - `portfolio_metrics_report.txt`: Provides a comprehensive summary of the portfolio analysis results.
  - `FirmsData.xlsx`: The initial dataset obtained from `scrapper.py`, containing financial data of various companies.
  - `LiquidityAnalysis.xlsx`: Generated by `constraints.py`, listing companies that meet liquidity criteria.
  - `FinancialHealth.xlsx`: Produced by `constraints.py`, detailing companies that pass the financial health filters.

### models/
Houses three Python scripts central to the project's functionality. Each script's purpose and execution order are detailed in the following sections.

### README.md
A comprehensive guide to the project, detailing its setup, execution, and functionalities.

### requirements.txt
Lists all Python libraries required for the project, ensuring consistent environments across setups.

## Models Directory

### Script Execution Order and Functions

1. **scrapper.py**
   - **Purpose**: Extracts financial data for a list of companies (TICKERS) provided by the user. The script focuses on liquidity and financial health metrics.
   - **Output**: Stores the scraped data in `FirmsData.xlsx`.

2. **constraints.py**
   - **Purpose**: Processes `FirmsData.xlsx` to filter companies based on liquidity and financial health constraints.
   - **Outputs**: Creates `LiquidityAnalysis.xlsx` for companies meeting liquidity criteria and `FinancialHealth.xlsx` for those passing financial health criteria.

3. **backtest.py**
   - **Purpose**: Uses TICKERS from companies that passed all filters, including a manual ESG filter. Extracts 5-year historical stock data for these companies and the ICLN fund (benchmark). Computes various metrics like volatility, maximum drawdown, annual and cumulative returns, Sharpe ratio, etc.
   - **Outputs**: Generates visuals (`cumulative_returns.png`, `drawdown.png`) and a summary report (`portfolio_metrics_report.txt`).

## Virtual Environment Setup

To isolate the project dependencies, we use a Python virtual environment. Follow these steps if you're unfamiliar with virtual environments:

1. **Install venv** (if not already installed):
   ```bash
   python3 -m pip install --user virtualenv
   ```

2. **Create a Virtual Environment** named `assetenv`:
   ```bash
   python3 -m venv assetenv
   ```

3. **Activate the Virtual Environment**:
   - On macOS and Linux:
     ```bash
     source assetenv/bin/activate
     ```
   - On Windows:
     ```bash
     .\assetenv\Scripts\activate
     ```

4. **Install Required Libraries** using `requirements.txt`:
   ```bash
   pip install -r requirements.txt
   ```

## Running the Scripts

Execute the scripts in the specified order:

1. Activate the virtual environment:
   - macOS/Linux: `source assetenv/bin/activate`
   - Windows: `.\assetenv\Scripts\activate`

2. Run the scripts:
   ```bash
   python models/scrapper.py
   python models/constraints.py
   python models/backtest.py
   ```

## Additional Notes

- Ensure that the `assets/` directory is properly set up before running the scripts.
- The manual ESG filter process is conducted offline and should be completed before running `backtest.py`.
- Review and adjust the TICKERS list in `scrapper.py` according to your research and investment criteria.
